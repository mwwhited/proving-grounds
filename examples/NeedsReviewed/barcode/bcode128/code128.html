<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<Title>iQs Partners Finland - Barcode 128</Title>









<Style Type="text/css">
<!--
Body, P, H1, H2, H3, H4, TD, TH, UL, Blockquote
  { font-family: Arial, Helvetica; }
-->
</Style>

<Body Bgcolor=White Text=Black Link=Blue aLink=Red vLink=Purple>

<Table Cellpadding=0 Cellspacing=0 Border=0 Width="100%">
<tr><td Colspan=5 Bgcolor=White>
<!--
<H2 Align=Right><Font Color="#CFCFCF">BARCODE 128</Font></H2>
-->
</td></tr>


  <tr>
    <td Bgcolor="White" Valign=Top>
      <H2 Align=Right><Font Color="#CFCFCF">BARCODE 128</Font></H2>
      <H3>Newest Release: 1.2 (7th March 2000)</H3>
      <H3>New</H3>
      <p Align=Justify>
        10th May 1998<br>
        <B>Barcode 128 released!</B>
      </p>
      <p Align=Justify>
        18th May 1998<br>
        <ul>
          <li>Check code 1 was not calculated correctly. <B>Fixed</B>
          <li>Some barcodes caused the end of the code to disappear. <B>Fixed</B>
          <li>Due date can now be left blank.
        </ul>
        If you're using iQs Barcode Control version 1.0, please download the newest
        version (1.1) to ensure it is working properly.
      </p>
      <p Align=Justify>
        10th January 1999<br>
        <ul>
          <li>The component is now a COM object, not an ActiveX object
          <li>You can select the currency type now (FIM / EURO)
          <li>There are no more floating point numbers, so there are no rounding errors
        </ul>
      </p>
      <p Align=Justify>
        17th March 1999<br>
        <ul>
          <li>Two numbers were coded wrong. <B>Fixed</B>
        </ul>
      </p>
      <p Align=Justify>
        7th March 2000<br>
        <ul>
          <li> The barcode component was revised to version 1.2. All known
               problems should be fixed.
        </ul>
      </p>

      <H3>Installing</H3>
      <p Align=Justify>
        Copy the barcode.dll into your Windows-directory and run <I>regsvr32 barcode.dll</I>.
      </p>
      <H3>General</H3>
      <p Align=Justify>
        The barcode 128C is used, for example, in invoices. This font and the
        additional software are free for personal and commercial use. The only
        requirement is that you must state the origin of the font in your
        product and inform us of its use.
      </p>
      <p Align=Justify>
        This font has not been confirmed by
        <a href="http://www.pankkiyhdistys.fi/">Suomen Pankkiyhdistys</a> yet, but
        it has been tested with their material and 
	  should work. However, iQs cannot be held responsible for any problems related
	  to the use of this font or the accompanying software.
      </p>
      <H3>Using the Font</H3>
      <p Align=Justify>
        The font can be used to print barcodes 128A, 128B and 128C. The accompanying
        software is designed for 128C.
      </p>
      <p Align=Justify>
        Each Code 128 character consists of three black and three white bars
        (except for the stop character which has an extra black bar).
        The bars have four different widths. The following table shows the
        encoding.
      </p>

<pre>
 ID   CodeA   CodeB  CodeC    B W B W B W
--------------------------------------------
  0   SPACE   SPACE   00      2 1 2 2 2 2
  1     !       !     01      2 2 2 1 2 2
  2     "       "     02      2 2 2 2 2 1
  3     #       #     03      1 2 1 2 2 3
  4     $       $     04      1 2 1 3 2 2
  5     %       %     05      1 3 1 2 2 2
  6     &       &     06      1 2 2 2 1 3
  7     '       '     07      1 2 2 3 1 2
  8     (       (     08      1 3 2 2 1 2
  9     )       )     09      2 2 1 2 1 3
  10    *       *     10      2 2 1 3 1 2
  11    +       +     11      2 3 1 2 1 2
  12    ,       ,     12      1 1 2 2 3 2
  13    -       -     13      1 2 2 1 3 2
  14    .       .     14      1 2 2 2 3 1
  15    /       /     15      1 1 3 2 2 2
  16    0       0     16      1 2 3 1 2 2
  17    1       1     17      1 2 3 2 2 1
  18    2       2     18      2 2 3 2 1 1
  19    3       3     19      2 2 1 1 3 2
  20    4       4     20      2 2 1 2 3 1
  21    5       5     21      2 1 3 2 1 2
  22    6       6     22      2 2 3 1 1 2
  23    7       7     23      3 1 2 1 3 1
  24    8       8     24      3 1 1 2 2 2
  25    9       9     25      3 2 1 1 2 2
  26    :       :     26      3 2 1 2 2 1
  27    ;       ;     27      3 1 2 2 1 2
  28    <       <     28      3 2 2 1 1 2
  29    =       =     29      3 2 2 2 1 1
  30    >       >     30      2 1 2 1 2 3
  31    ?       ?     31      2 1 2 3 2 1
  32    @       @     32      2 3 2 1 2 1
  33    A       A     33      1 1 1 3 2 3
  34    B       B     34      1 3 1 1 2 3
  35    C       C     35      1 3 1 3 2 1
  36    D       D     36      1 1 2 3 1 3
  37    E       E     37      1 3 2 1 1 3
  38    F       F     38      1 3 2 3 1 1
  39    G       G     39      2 1 1 3 1 3
  40    H       H     40      2 3 1 1 1 3
  41    I       I     41      2 3 1 3 1 1
  42    J       J     42      1 1 2 1 3 3
  43    K       K     43      1 1 2 3 3 1
  44    L       L     44      1 3 2 1 3 1
  45    M       M     45      1 1 3 1 2 3
  46    N       N     46      1 1 3 3 2 1
  47    O       O     47      1 3 3 1 2 1
  48    P       P     48      3 1 3 1 2 1
  49    Q       Q     49      2 1 1 3 3 1
  50    R       R     50      2 3 1 1 3 1
  51    S       S     51      2 1 3 1 1 3
  52    T       T     52      2 1 3 3 1 1
  53    U       U     53      2 1 3 1 3 1
  54    V       V     54      3 1 1 1 2 3
  55    W       W     55      3 1 1 3 2 1
  56    X       X     56      3 3 1 1 2 1
  57    Y       Y     57      3 1 2 1 1 3
  58    Z       Z     58      3 1 2 3 1 1
  59    [       [     59      3 3 2 1 1 1
  60    \       \     60      3 1 4 1 1 1
  61    ]       ]     61      2 2 1 4 1 1
  62    ^       ^     62      4 3 1 1 1 1
  63    _       _     63      1 1 1 2 2 4
  64    NU      `     64      1 1 1 4 2 2
  65    SH      a     65      1 2 1 1 2 4
  66    SX      b     66      1 2 1 4 2 1
  67    EX      c     67      1 4 1 1 2 2
  68    ET      d     68      1 4 1 2 2 1
  69    EQ      e     69      1 1 2 2 1 4
  70    AK      f     70      1 1 2 4 1 2
  71    BL      g     71      1 2 2 1 1 4
  72    BS      h     72      1 2 2 4 1 1
  73    HT      i     73      1 4 2 1 1 2
  74    LF      j     74      1 4 2 2 1 1
  75    VT      k     75      2 4 1 2 1 1
  76    FF      l     76      2 2 1 1 1 4
  77    CR      m     77      4 1 3 1 1 1
  78    SO      n     78      2 4 1 1 1 2
  79    SI      o     79      1 3 4 1 1 1
  80    DL      p     80      1 1 1 2 4 2
  81    D1      q     81      1 2 1 1 4 2
  82    D2      r     82      1 2 1 2 4 1
  83    D3      s     83      1 1 4 2 1 2
  84    D4      t     84      1 2 4 1 1 2
  85    NK      u     85      1 2 4 2 1 1
  86    SY      v     86      4 1 1 2 1 2
  87    EB      w     87      4 2 1 1 1 2
  88    CN      x     88      4 2 1 2 1 1
  89    EM      y     89      2 1 2 1 4 1
  90    SB      z     90      2 1 4 1 2 1
  91    EC      {     91      4 1 2 1 2 1
  92    FS            92      1 1 1 1 4 3
  93    GS      }     93      1 1 1 3 4 1
  94    RS      ~     94      1 3 1 1 4 1
  95    US     DEL    95      1 1 4 1 1 3
  96   FNC3    FNC3   96      1 1 4 3 1 1
  97   FNC2    FNC2   97      4 1 1 1 1 3
  98  SHIFT   SHIFT   98      4 1 1 3 1 1
  99  CODEC   CODEC   99      1 1 3 1 4 1
  100 CODEB    FNC4  CODEB    1 1 4 1 3 1
  101  FNC4   CODEA  CODEA    3 1 1 1 4 1
  102  FNC1    FNC1  FNC1     4 1 1 1 3 1

Start Codes
  103 CODEA                   2 1 1 4 1 2
  104 CODEB                   2 1 1 2 1 4
  105 CODEC                   2 1 1 2 3 2

Stop Code
  106 STOP                    2 3 3 1 1 1 2
</pre>
      <p Align=Justify>
        The font consists of sixteen different barcode slices, the start codes
        and the stop code. The keymappings are:
      </p>
      <Table Border=1 Cellpadding=2>
        <tr>
          <th>&nbsp;Key&nbsp;</th>
          <th>&nbsp;Stripes&nbsp;</th>
        </tr>
        <tr>
          <td>0</td>
          <td>1 1</td>
        </tr>
        <tr>
          <td>1</td>
          <td>2 1</td>
        </tr>
        <tr>
          <td>2</td>
          <td>3 1</td>
        </tr>
        <tr>
          <td>3</td>
          <td>4 1</td>
        </tr>
        <tr>
          <td>4</td>
          <td>1 2</td>
        </tr>
        <tr>
          <td>5</td>
          <td>2 2</td>
        </tr>
        <tr>
          <td>6</td>
          <td>3 2</td>
        </tr>
        <tr>
          <td>7</td>
          <td>4 2</td>
        </tr>
        <tr>
          <td>8</td>
          <td>1 3</td>
        </tr>
        <tr>
          <td>9</td>
          <td>2 3</td>
        </tr>
        <tr>
          <td>:</td>
          <td>3 3</td>
        </tr>
        <tr>
          <td>;</td>
          <td>4 3</td>
        </tr>
        <tr>
          <td>&lt;</td>
          <td>1 4</td>
        </tr>
        <tr>
          <td>=</td>
          <td>2 4</td>
        </tr>
        <tr>
          <td>&gt;</td>
          <td>3 4</td>
        </tr>
        <tr>
          <td>?</td>
          <td>4 4</td>
        </tr>
        <tr><th Colspan=2>Start Codes</th></tr>
        <tr>
          <td>A</td>
          <td>2 1 1 4 1 2</td>
        </tr>
        <tr>
          <td>B</td>
          <td>2 1 1 2 1 4</td>
        </tr>
        <tr>
          <td>C</td>
          <td>2 1 1 2 3 2</td>
        </tr>
        <tr><th Colspan=2>Stop Code</th></tr>
        <tr>
          <td>@</td>
          <td>2 3 3 1 1 1 2</td>
        </tr>
      </Table>
      <p Align=Justify>
        So for example, the code for '00' would be '155'.
      </p>
      <p Align=Justify>
        The barcode used in invoices (at least in Finland, that is) consists of
        the following parts.
      </p>
      <Table Border=1 Cellpadding=2>
        <tr>
          <th>&nbsp;Length&nbsp;</th>
          <th>&nbsp;Explanation&nbsp;</th>
        </tr>
        <tr>
          <td>2</td>
          <td>Start Code</td>
        </tr>
        <tr>
          <td>1</td>
          <td>Currency (1=FIM, 2=EURO. EURO must not be used before
              1.1.1999!)</td>
        </tr>
        <tr>
          <td>14</td>
          <td>Zero-padded account number. The zeroes are added after the
              sixth number except in numbers that begin with 4 or 5. Those
              are padded after the seventh number.
        </tr>
        <tr>
          <td>8</td>
          <td>Amount. The format is xxxxxx.xx, so you can't charge your
              customers millions ;)</td>
        </tr>
        <tr>
          <td>20</td>
          <td>Reference Number</td>
        </tr>
        <tr>
          <td>6</td>
          <td>Due Date. Format is YYMMDD.</td>
        </tr>
        <tr>
          <td>4</td>
          <td>Zero padding</td>
        </tr>
        <tr>
          <td>1</td>
          <td>Check code 1</td>
        </tr>
        <tr>
          <td>2</td>
          <td>Check code 2</td>
        </tr>
        <tr>
          <td>2</td>
          <td>Stop code</td>
        </tr>
      </Table>
      <H3>Check Code 1</H3>
      <p Align=Justify>
        Check code 1 is part of the <em>bank barcode</em>, not part of the barcode 128.
        The code is calculated the same way as the check code for reference number.
        So, it's the sum of the number multiplied with 7, 3 or 1
        counting from the end.
        Here is some sample code:
<pre>
//  bcode is a string containing the barcode data
  int   val, i, paino;

  paino=7;
  val =0;
  for (i=53; i--;)
  {
    val += (bcode[i]-48)*paino;
    if (paino == 7) paino=3;
    else if (paino == 3) paino=1;
    else paino=7;
  }
  val = val%10;
  val = 10-val;
// Now the check code 1 is in val
</pre>
      </p>
      <H3>Check Code 2</H3>
      <p Align=Justify>
        The check code is the modulo 103 of the weighted sum of the codes
        except the stop code (talk about obscure sentences).
        Here is an excerpt of the code we use:
<pre>
//  bcode is a string containing the barcode data
  int   val, i;

  val = 105;
  for (i=0; i<27; i++)
  {
    j = (bcode[i*2]-48)*10+bcode[i*2+1]-48;
    val += (i+1)*j;
  }
  val -= (val/103)*103;

//  val is the check code and can be inserted into the barcode
</pre>
      </p>
      <H3>Using the ActiveX Control</H3>
      <p Align=Justify>
        The ActiveX control can be used to generate the correct output for
        barcodes in invoices. Here is an excerpt of Visual Basic code that
        demonstrates its usage:
      </p>
<pre>
' Barcode1 is the iQs Barcode Control
' Label1 is a label with the iQs Code128 font

  Dim Barcode1 as Object
  Set Barcode1 = CreateObject("bar.bar.1")

  Account = "240342-5209"
  Due = "970920"
  Total = 67920 'This is actually 679.20 but you have to multiply it by 100
  ' NOTICE! If you have no pennies (e.g. 123,00), you MUST include the
  '         trainling zeroes! So it would become 12300, not 123!
  Reference = "5461523456126"
  Currency = 1 ' 1=FIM, 2=EURO
  Label1.Caption = Barcode1.CreateBarcode(Total, Currency, Account, Due, Reference)
</pre>
      <p Align=Justify>
        As you can see, it is easy to use. Just input the account number,
        due date, total amount, currency  and reference number and it gives
        you the correct string.
      </p>
      <H3>Disclaimer</H3>
<p>
The product (including instructions for its use) is provided "as is" without
warranty of any kind. iQs Partners Finland further disclaims all implied
warranties including without limitation any implied warranties of
merchantability or of fitness for a particular purpose. The entire risk
arising out of the use or performance of the product and documentation remains
with you.
</p>
<p>
In no event shall iQs Partners Finland or anyone else involved in the creation,
production or delivery of the product be liable for any damages whatsoever
(including, without limitation, damages for loss of business profits, business
interruption, loss of business information, or other pecuniary loss) arising
out of the use of or inability to use the product or documentation, even if
iQs Partners Finland has been advised of the possibility of such damages.
</p>

<p Align=Justify>
<a href="mailto:bugs@iqs.fi">Mail a bug report</a><br>
<a href="http://www.iqs.fi/dload.shtml">Download Barcode 128</a><br>
<a href="http://www.iqs.fi/products/">Back to the Products page</a>
</p>
<br>
    </td>
  </tr>

<tr><td Colspan=5 Bgcolor=White>
<p>
<hr>

<br>
&nbsp;&nbsp;&copy; 1999 - iQs Partners Finland - <a href="mailto:iqs@iqs.fi">iqs@iqs.fi</a>
<br>


<!-- &nbsp;&nbsp;Last modified: 07.03.00<br> -->

<br>
</td>
</tr>
</Table>
</Body>

